<Ui>

	<Frame name="TellMeWhen_GM_Rename" inherits="TellMeWhen_OptionsModuleContainer" virtual="true">
		<!-- <Size y="50"/> -->
		<Frames>
			<EditBox parentKey="Name" inherits="TellMeWhen_InputBoxTemplate" multiline="true" autoFocus="false">
				<Size x="545" y="15"/>
				<Anchors>
					<Anchor point="TOP" y="-5"/>
					<Anchor point="LEFT" x="9" />
					<Anchor point="RIGHT" x="-9" />
				</Anchors>
				<Layers>
					<Layer level="ARTWORK">
						<FontString inherits="GameFontHighlightSmall" parentKey="text" justifyH="LEFT">
							<Anchors>
								<Anchor point="LEFT" relativePoint="RIGHT" x="19" y="-1"/>
							</Anchors>
						</FontString>
					</Layer>
				</Layers>
				<Scripts>
					<OnLoad>
						self.BackgroundText:SetWidth(self:GetWidth())
						
						TMW:CInit(self)

						self:SetTexts(TMW.L["UIPANEL_GROUPNAME"], nil)
						self:SetSetting("Name")
						
						self:CScriptAdd("ModifySettingValueRequested", function(self, value)
							return TMW:CleanString(value)
						end)

					</OnLoad>
					
					<OnTextChanged>
						-- TODO: this should be integrated with Config_EditBox
						local text = self:GetText()
						if text == "" then
							local label = self.label
							self.BackgroundText:SetText(label)
						else
							self.BackgroundText:SetText(nil)
						end
						
						if self:GetParent().AdjustHeight then
							self:GetParent():AdjustHeight()
						end
					</OnTextChanged>
				</Scripts>
			</EditBox>
		</Frames>
		<Scripts>
			<OnLoad>		
				self.Header:SetText(TMW.L["UIPANEL_GROUPNAME"])
			</OnLoad>
		</Scripts>
	</Frame>


	<Frame name="TellMeWhen_GM_DBLoc" inherits="TellMeWhen_OptionsModuleContainer" virtual="true">
		<Size y="70"/>
		<Frames>
			<Slider parentKey="ID" inherits="TellMeWhen_SliderTemplate">
				<Anchors>
					<Anchor point="TOP" y="-13"/>
					<Anchor point="LEFT" x="10" />
					<Anchor point="RIGHT" relativePoint="CENTER" x="0" />
				</Anchors>
				<Scripts>
					<OnLoad>						
						TMW:CInit(self)

						self:SetRange(20)
						self:SetValueStep(1)
						self:SetMode(self.MODE_ADJUSTING)
						self:SetTexts(TMW.L["UIPANEL_GROUPID"], TMW.L["UIPANEL_GROUPID_DESC"])

						self:CScriptAdd("ReloadRequested", function(requester)
							if TMW.CI.group then
								self:SetMinMaxValues(1, #TMW[TMW.CI.group.Domain])
								self:SetValue(TMW.CI.group:GetID())
							end
						end)

						self:PostHookMethod("SaveSetting", function(self)
							local group = TMW.CI.group
							local oldID = group.ID
							local newID = self:GetValue() -- DO NOT USE the value param from the script. It won't be an integer.

							TMW:Group_Swap(group.Domain, oldID, newID)
						end)
					</OnLoad>
				</Scripts>
			</Slider>
			<CheckButton parentKey="Global" inherits="TellMeWhen_CheckTemplate">
				<Anchors>
					<Anchor point="LEFT" relativeKey="$parent.ID" relativePoint="RIGHT" x="15" y="0"/>
				</Anchors>

				<Scripts>
					<OnLoad>
						TMW:CInit(self)
						self:SetTexts(TMW.L["DOMAIN_GLOBAL_SWITCHTO"], TMW.L["GLOBAL_GROUP_GENERIC_DESC"])
						self:ConstrainLabel(self:GetParent(), "RIGHT")

						self:CScriptAdd("ReloadRequested", function()
							if TMW.CI.group then
								self:SetChecked(TMW.CI.group.Domain == "global")
							end
						end)
					</OnLoad>
					<OnClick>
						local group = TMW.CI.group
						if group then
							TMW:Group_SwapDomain(group)
						end
					</OnClick>
				</Scripts>
			</CheckButton>

			<Button parentKey="Delete" inherits="TellMeWhen_ButtonTemplate">
				<Size y="15"/>
				<Anchors>
					<Anchor point="BOTTOM" y="10"/>
					<Anchor point="LEFT" x="7" />
					<Anchor point="RIGHT" x="-7" />
				</Anchors>

				<Scripts>
					<OnLoad>
						self:SetText(TMW.L["UIPANEL_DELGROUP"])
					</OnLoad>
					<OnClick>
						local group = TMW.CI.group

						if TMW:Group_HasIconData(group) then
							TMW.IE:ShowConfirmation(
								TMW.L["CONFIRM_DELGROUP"],
								TMW.L["CONFIRM_DELGROUP_DESC"]:format(group:GetGroupName()),
								function()
									TMW:Group_Delete(group)
								end
							)
						else
							TMW:Group_Delete(group)
						end
					</OnClick>
				</Scripts>
			</Button>
		</Frames>
		<Scripts>
			<OnLoad>
				self.Header:SetText(TMW.L["UIPANEL_DBLOC"])
			</OnLoad>
		</Scripts>
	</Frame>



	<Frame name="TellMeWhen_GM_Dims" inherits="TellMeWhen_OptionsModuleContainer" virtual="true">
		<Size y="85"/>
		<Frames>
			<Slider parentKey="Rows" inherits="TellMeWhen_SliderTemplate">
				<Anchors>
					<Anchor point="TOP" y="-13"/>
					<Anchor point="LEFT" x="10" />
					<Anchor point="RIGHT" x="-10" />
				</Anchors>
				<Scripts>
					<OnLoad>
						TMW:CInit(self)

						self:SetTexts(TMW.L["UIPANEL_ROWS"], TMW.L["UIPANEL_TOOLTIP_ROWS"])
						self:SetSetting("Rows")
						self:SetMinMaxValues(1, TELLMEWHEN_MAXROWS)
						self:SetValueStep(1)
					</OnLoad>
				</Scripts>
			</Slider>
			<Slider parentKey="Columns" inherits="TellMeWhen_SliderTemplate">
				<Anchors>
					<Anchor point="TOPLEFT" relativeKey="$parent.Rows" y="-40"/>
					<Anchor point="TOPRIGHT" relativeKey="$parent.Rows" y="-40"/>
				</Anchors>
				<Scripts>
					<OnLoad>
						TMW:CInit(self)

						self:SetTexts(TMW.L["UIPANEL_COLUMNS"], TMW.L["UIPANEL_TOOLTIP_COLUMNS"])
						self:SetSetting("Columns")
						self:SetMinMaxValues(1, TELLMEWHEN_MAXROWS)
						self:SetValueStep(1)
					</OnLoad>
				</Scripts>
			</Slider>
		</Frames>
		<Scripts>
			<OnLoad>
				self.Header:SetText(TMW.L["UIPANEL_DIMENSIONS"])
			</OnLoad>
		</Scripts>
	</Frame>
 
</Ui>